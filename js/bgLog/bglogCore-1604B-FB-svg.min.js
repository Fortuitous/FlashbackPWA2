for(var numberOfCubes=1,maxCubes=4,topCubes=[maxCubes,maxCubes,maxCubes,maxCubes],midCubes=[maxCubes,maxCubes,maxCubes,maxCubes],botCubes=[maxCubes,maxCubes,maxCubes,maxCubes],multiCubeOffset=0,cubePos="mid",cubeValue=0,cubeNumber=1,xgEmptyId="XGID=--------------------------:0:0:1:00:0:0:0:0:10",xgStartPos="XGID=-b----E-C---eE---c-e----B-:0:0:1:00:0:0:0:0:10",xgNackStartPos="XGID=-bb---D-C---dD---c-d---BB-:0:0:1:00:0:0:0:0:10",xgPos=xgStartPos,defaultTheme=theme1,currentTheme=defaultTheme,borderSize,trayX,ourPoint,savedPos=xgEmptyId,idMessage="",idWarningFlag=!1,idErrorFlag=!1,roll=!0,turn=!0,editMode=!1,recMode=!1,firstRoll=!1,matchInProgress=!1,cubeFlag=!1,twoCubesFlag=!1,diceSwapFlag=!1,swapSidesFlag=!1,snapBackFlag=!1,undoMoveFlag=!1,dragging=!1,checkerTweenActive=!1,drawFlag=!0,animateFlag=!0,badAndroidFlag=!1,checkerSize=60,lineWidth=checkerSize/60,doubleLineWidth=2*lineWidth,trayCheckerCornerRadius=checkerSize/10,cubeLineWidth=checkerSize/5,ourScore=0,oppScore=0,leftDie=0,rightDie=0,highDie=0,lowDie=0,thisLeftDie=0,thisRightDie=0,matchLength=0,cubeStatus=0,nackFlag=0,crawfordFlag=0,jacobyFlag=0,beaverFlag=0,resignFlag=0,moveCount=0,count=0,size=0,gameState=1,oppBoard=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),ourBoard=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),ourCheckerNameArray=new Array(25),i=0;i<ourCheckerNameArray.length;i++){ourCheckerNameArray[i]=new Array(15);for(var j=0;15>j;j++)ourCheckerNameArray[i][j]=-1}for(var oppCheckerNameArray=new Array(25),i=0;i<oppCheckerNameArray.length;i++){oppCheckerNameArray[i]=new Array(15);for(var j=0;15>j;j++)oppCheckerNameArray[i][j]=-1}for(var ourTrayCheckerArray=[],oppTrayCheckerArray=[],moveListArray=new Array(30),i=0;30>i;i++)moveListArray[i]=new Array(0);var moveArray=[[0,0,"+",-1],[0,0,"+",-1],[0,0,"+",-1],[0,0,"+",-1]];bglogSVG={getPipCount:function(){thisPipCount=0,ourPipCount=0,oppPipCount=0;for(var e=0;25>e;e++)ourBoard[e]>0&&(ourPipCount+=ourBoard[e]*(e+1)),oppBoard[e]>0&&(oppPipCount+=oppBoard[e]*(e+1));roll?thisPipCount=ourPipCount:thisPipCount=oppPipCount},move:function(e,r,o){if(e!=r){var t=24,i=-(r-23);roll?thisBoard=ourBoard:thisBoard=oppBoard;var c=thisBoard;thisToPoint=r,thisFromPoint=e;for(var a=0,n=0,h=24;h>5;h--)a+=ourBoard[h];for(var h=24;h>5;h--)n+=oppBoard[h];if(e==t&&undoMoveFlag&&(thisBoard==ourBoard?(thisBoard=oppBoard,otherBoard=ourBoard):(thisBoard=ourBoard,otherBoard=oppBoard),thisToPoint=i),thisBoard==ourBoard?(otherBoard=oppBoard,checkerNameArray=ourCheckerNameArray,otherCheckerNameArray=oppCheckerNameArray,trayCheckerArray=ourTrayCheckerArray,checkers=a):(otherBoard=ourBoard,checkerNameArray=oppCheckerNameArray,otherCheckerNameArray=ourCheckerNameArray,trayCheckerArray=oppTrayCheckerArray,checkers=n),0>e&&undoMoveFlag)return checkerName=trayCheckerArray.pop(),r>=0&&(checkerNameArray[r][thisBoard[r]]=checkerName),bglog.pointToXY(r,thisBoard[r],thisBoard),thisBoard[r]+=o,thisFromPoint=-1,moveListArray[checkerName].push(pointX,pointY),bglog.runMoveList(),void(savedPos=xgPos);if(checkerName=checkerNameArray[e][thisBoard[e]-1],void 0==checkerName||-1==checkerName)return void console.log("checkerName not found!!");if(checkerNameArray[e][thisBoard[e]-1]=-1,r>=0&&(checkerNameArray[r][thisBoard[r]]=checkerName),0>r)(0==checkers||editMode)&&(thisBoard[e]-=o,trayCheckerArray.push(checkerName),bglog.pointToXY(r,0,thisBoard),moveListArray[checkerName].push(pointX,pointY),diceToPlay-=o,pipsToMove-=(e-r)*o,bglog.saveMove(e+1,"o",o,"",checkerName));else{if(bglog.pointToXY(r,thisBoard[r],thisBoard),hit="",thisBoard[e]-=o,thisBoard[r]+=o,moveListArray[checkerName].push(pointX,pointY),diceToPlay-=o,pipsToMove-=(e-r)*o,1==otherBoard[i]){if(otherBoard[i]=0,otherBoard[t]+=1,hit="*",hitChecker=otherCheckerNameArray[i][otherBoard[i]],void 0==hitChecker||-1==hitChecker)return void console.log("hitChecker "+hitChecker+" not found!!");otherCheckerNameArray[i][otherBoard[i]]=-1,otherCheckerNameArray[t][otherBoard[t]-1]=hitChecker,bglog.pointToXY(t,otherBoard[t]-1,otherBoard),thisToPoint=t,moveListArray[hitChecker].push(pointX,pointY)}bglog.saveMove(e+1,r+1,o,hit,checkerName)}thisBoard=c,0==pipsToMove&&(diceToPlay=0),bglog.runMoveList()}},runMoveList:function(){for(var e=0;e<oppBoard.length;e++){if(oppBoard[e]>0)for(j=0;j<oppBoard[e];j++)bglog.generateMove(oppCheckerNameArray[e][j]);if(ourBoard[e]>0)for(j=0;j<ourBoard[e];j++)bglog.generateMove(ourCheckerNameArray[e][j])}for(var e=0;e<moveListArray.length;e++)bglog.generateMove(e);bglog.updatePipCount(),bglog.boardToXGpos()},generateMove:function(e){if(moveListArray[e].length>0){var r=moveListArray[e].pop(),o=moveListArray[e].pop();moveListArray[e]=[],bglog.moveChecker(e,o,r,currentTheme.animateSpeed)}},saveMove:function(e,r,o,t,i){undoMoveFlag||(moveArray[moveCount][0]=e,moveArray[moveCount][1]=r,moveArray[moveCount][2]=o,moveArray[moveCount][3]=t,moveArray[moveCount][4]=i,moveCount++)},clearMoveArray:function(){for(var e=0;4>e;e++)moveArray[e][0]=0,moveArray[e][1]=0,moveArray[e][2]=0,moveArray[e][3]="+",moveArray[e][4]=-1},undoMove:function(){if(moveCount>0){undoMoveFlag=!0;for(var e=moveCount-1;e>=0;e--)if(checkerName=moveArray[e][4],thisFromPoint=moveArray[e][1],"o"==thisFromPoint?thisFromPoint=-1:thisFromPoint--,bglog.move(thisFromPoint,moveArray[e][0]-1,moveArray[e][2]),"*"==moveArray[e][3]){var r=moveArray[e][1]-1;bglog.move(24,-(r-23),1)}bglog.clearMoveArray(),moveCount=0,diceToPlay=2,pipsToMove=leftDie+rightDie,leftDie==rightDie&&(pipsToMove+=pipsToMove,diceToPlay=4),undoMoveFlag=!1}},XYtoPointCount:function(e,r){e<leftX||e>rightX+checkerSize?(ourPoint=-1,oppPoint=-1,thisPoint=-1):e>=leftX+6*checkerSize&&e<=leftX+7*checkerSize?(ourPoint=24,oppPoint=24,thisPoint=24):r<=middleY?e<leftX+6*checkerSize?ourPoint=-((e-leftX)/checkerSize)+24:(e-=checkerSize,ourPoint=-((e-leftX)/checkerSize)+24):e<leftX+6*checkerSize?ourPoint=(e-leftX)/checkerSize-0:(e-=checkerSize,ourPoint=(e-leftX)/checkerSize-0),ourPoint=Math.floor(ourPoint),count=0,r<topY&&e>leftX&&e<rightX+checkerSize&&(count=0),count=r>bottomY&&e>leftX&&e<rightX+checkerSize?0:r<middleY-checkerSize/2?Math.ceil((r-topY)/checkerSize):r>middleY+checkerSize/2?Math.ceil(-(r-topY)/checkerSize+11):6,currentTheme.direction||24==ourPoint||-1==ourPoint||(ourPoint=12>ourPoint?-ourPoint+11:-ourPoint+35),24==ourPoint?oppPoint=24:-1!=ourPoint&&(oppPoint=-(ourPoint-23));for(var o=0,t=0,i=24;i>5;i--)o+=ourBoard[i];for(var i=24;i>5;i--)t+=oppBoard[i];roll?(thisBoard=ourBoard,otherBoard=oppBoard,thisPoint=ourPoint,otherPoint=oppPoint,checkers=o,checkerColor=currentTheme.ourCheckerColor):(thisBoard=oppBoard,otherBoard=ourBoard,thisPoint=oppPoint,otherPoint=ourPoint,checkers=t,checkerColor=currentTheme.oppCheckerColor)},loadXgId:function(e){""!=e&&void 0!==e&&(bglog.xgPosToBoard(e),bglog.xgMatchToBoard(e),bglog.drawCheckers(),bglog.setDice(),bglog.doPointNumbers())},loadgnuId:function(e){var r=e.split(":");gnuPosid=r[0],gnuMatchid=r[1],null!=gnuMatchid&&bglog.matchid2board(gnuMatchid),null!=gnuPosid&&bglog.posid2board(gnuPosid),bglog.drawCheckers(),bglog.setDice(),bglog.doPointNumbers()},swapSides:function(){bglog.swapColors(),bglog.toggleRoll();var e=ourBoard;ourBoard=oppBoard,oppBoard=e,animateFlag=!1,bglog.drawCheckers(),swapSidesFlag=swapSidesFlag?!1:!0,twoCubesFlag&&(swapSidesFlag?bglog.moveCube(2,"top",1):bglog.moveCube(2,"bot",1)),animateFlag=!0},swapColors:function(){var e=currentTheme.ourCheckerColor;currentTheme.ourCheckerColor=currentTheme.oppCheckerColor,currentTheme.oppCheckerColor=e,currentTheme.oppDiceColour=e,e=currentTheme.ourDicePipColor,currentTheme.ourDicePipColor=currentTheme.oppDicePipColor,currentTheme.oppDicePipColor=e,e=currentTheme.ourStackingColor,currentTheme.ourStackingColor=currentTheme.oppStackingColor,currentTheme.oppStackingColor=e,bglog.loadTheme(currentTheme)},setDice:function(){if(0==leftDie&&0==rightDie||!currentTheme.showDice)return void bglog.hideDice();if(roll){$(".oppdice").hide(),$(".ourdice").show();var e="our"}else{$(".ourdice").hide(),$(".oppdice").show();var e="opp"}bglog.showDice(e+"L",leftDie),bglog.showDice(e+"R",rightDie)},showDice:function(e,r){$("#"+e+"tlPip").hide(),$("#"+e+"trPip").hide(),$("#"+e+"clPip").hide(),$("#"+e+"cPip").hide(),$("#"+e+"crPip").hide(),$("#"+e+"blPip").hide(),$("#"+e+"brPip").hide(),1==r?$("#"+e+"cPip").show():2==r?($("#"+e+"tlPip").show(),$("#"+e+"brPip").show()):3==r?($("#"+e+"trPip").show(),$("#"+e+"cPip").show(),$("#"+e+"blPip").show()):4==r?($("#"+e+"tlPip").show(),$("#"+e+"trPip").show(),$("#"+e+"blPip").show(),$("#"+e+"brPip").show()):5==r?($("#"+e+"tlPip").show(),$("#"+e+"trPip").show(),$("#"+e+"cPip").show(),$("#"+e+"blPip").show(),$("#"+e+"brPip").show()):6==r&&($("#"+e+"tlPip").show(),$("#"+e+"trPip").show(),$("#"+e+"clPip").show(),$("#"+e+"crPip").show(),$("#"+e+"blPip").show(),$("#"+e+"brPip").show())},hideDice:function(){$(".dice").hide()},toggleDirection:function(){currentTheme.direction?currentTheme.direction=!1:currentTheme.direction=!0,animateFlag=!1,bglog.doCubes(),bglog.updateScores();var e=trayX;bglog.updateTrays();for(var r=0;30>r;r++){var o=$("#checker"+r),t=$("#checkerCircle"+r),i=0;o[0]._gsTransform&&(i=o[0]._gsTransform.x),i==e&&i!=trayX&&(TweenLite.set(o,{x:trayX}),TweenLite.set(t,{attr:{height:trayCheckerHeight,rx:trayCheckerCornerRadius}}))}var c=xgPos;bglog.loadXgId(xgEmptyId),bglog.loadXgId(c),animateFlag=!0},toggleRoll:function(){roll=roll?!1:!0,bglog.setDice(),bglog.updateScores(),bglog.boardToXGpos(),bglog.doPointNumbers(),savedPos=xgPos},updateTrays:function(){trayX=rightX+checkerSize+borderWidth,currentTheme.direction&&(trayX=leftX-checkerSize-borderWidth)},toggleStacking:function(){currentTheme.stacking?currentTheme.stacking=!1:currentTheme.stacking=!0,bglog.drawCheckers()},toggleShowNumbers:function(){currentTheme.showPointNumbers?currentTheme.showPointNumbers=!1:currentTheme.showPointNumbers=!0,bglog.doPointNumbers()},togglecpStyle:function(){currentTheme.cpStyle?currentTheme.cpStyle=!1:currentTheme.cpStyle=!0,bglog.doPointNumbers()},toggletakiPoints:function(){currentTheme.takiPoints?currentTheme.takiPoints=!1:currentTheme.takiPoints=!0,$(".takiPoint").hide(),$(".nonTakiPoint").hide(),currentTheme.takiPoints?$(".takiPoint").show():$(".nonTakiPoint").show()},togglePipCount:function(){currentTheme.showPipCount?currentTheme.showPipCount=!1:currentTheme.showPipCount=!0,bglog.updatePipCount()},toggleCube:function(){currentTheme.showCube?currentTheme.showCube=!1:currentTheme.showCube=!0},toggleIDs:function(){currentTheme.showIDs?currentTheme.showIDs=!1:currentTheme.showIDs=!0},toggleEdit:function(){editMode=editMode?!1:!0},toggleDice:function(){currentTheme.showDice?currentTheme.showDice=!1:currentTheme.showDice=!0,currentTheme.showDice?bglog.setDice():bglog.hideDice()},toggleScore:function(){currentTheme.showScore?currentTheme.showScore=!1:currentTheme.showScore=!0,currentTheme.showScore&&0!=matchLength?($("#ourScoreText").show(),$("#oppScoreText").show()):($("#ourScoreText").hide(),$("#oppScoreText").hide())},toggleTurnIndicator:function(){currentTheme.showTurnIndicator?currentTheme.showTurnIndicator=!1:currentTheme.showTurnIndicator=!0,currentTheme.direction?($("#ourScoreText").attr("x",leftX-borderWidth-checkerSize/2),$("#oppScoreText").attr("x",leftX-borderWidth-checkerSize/2)):($("#ourScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2),$("#oppScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2)),currentTheme.showTurnIndicator?roll?($("#oppTurnChecker").hide(),$("#ourTurnChecker").show()):($("#oppTurnChecker").show(),$("#ourTurnChecker").hide()):($("#ourTurnChecker").hide(),$("#oppTurnChecker").hide()),bglog.updateScores()},toggleAwayStyle:function(){currentTheme.awayStyle?currentTheme.awayStyle=!1:currentTheme.awayStyle=!0,bglog.updateScores()},toggleCubeStart:function(){currentTheme.cubeStart?currentTheme.cubeStart=!1:currentTheme.cubeStart=!0,bglog.doCubes()},setAnimationSpeed:function(e){currentTheme.animateSpeed=e},moveCube:function(e,r,o){var t=e-1,i=r,c=$("#cube"+t+"Text"),a=o,n=1*checkerSize+1*borderWidth+(size-cubeWidth)/2,h=5*checkerSize+borderWidth+pipCountFontSize+(size-cubeWidth)/2;if($("#cube"+t).css("visibility","visible"),"off"==r)return void $("#cube"+t).css("visibility","hidden");if("on"==r)return void $("#cube"+t).css("visibility","visible");currentTheme.cubeStart&&"mid"==i&&0==a&&(a=6);var u=Math.pow(2,a);if(c.text(u+""),1==crawfordFlag&&c.text("C"),0!=t||"ourside"!=i&&"oppside"!=i){for(var l=0;maxCubes>l;l++)topCubes[l]==t&&(topCubes[l]=maxCubes),midCubes[l]==t&&(midCubes[l]=maxCubes),botCubes[l]==t&&(botCubes[l]=maxCubes);if("top"==i)for(var l=0;maxCubes>l;l++)if(topCubes[l]==maxCubes){topCubes[l]=t;break}if("mid"==i)for(var l=0;maxCubes>l;l++)if(midCubes[l]==maxCubes){midCubes[l]=t;break}if("bot"==i)for(var l=0;maxCubes>l;l++)if(botCubes[l]==maxCubes){botCubes[l]=t;break}topCubes.sort(),midCubes.sort(),botCubes.sort(),bglog.doCubes()}else n=leftX+6*checkerSize+cubeLineWidth/2,h=topY+5*checkerSize+cubeLineWidth/2,currentTheme.direction?n-=3.5*checkerSize:n+=3.5*checkerSize,"ourside"==i&&(h+=3*checkerSize),"oppside"==i&&(h-=3*checkerSize),bglog.animateCube(t,n,h)},showCubes:function(){if(currentTheme.showCube)for(var e=0;maxCubes>e;e++)e>=numberOfCubes?allCubeGroups[e].hide():allCubeGroups[e].show();else allCubeGroups.hide();bglog.drawLayer(movingLayer)},animateCube:function(e,r,o){if(drawFlag){var t=currentTheme.animateSpeed;animateFlag||(t=0),bglog.moveToTop($("#cube"+e)),TweenLite.to($("#cube"+e),2*t,{x:r,y:o,ease:Power4.easeInOut})}},doCubes:function(){var e=cubeLineWidth/2;1==numberOfCubes||2==numberOfCubes&&twoCubesFlag?cubeX=leftX+6*checkerSize+e-doubleLineWidth:(cubeX=e,currentTheme.direction||(cubeX=2.5*checkerSize+rightX));for(var r=0,o=0;maxCubes>o;o++)midCubes[o]<maxCubes&&r++;for(var o=0;maxCubes>o;o++){var t=topY+doubleLineWidth;topCubes[o]<maxCubes&&bglog.animateCube(topCubes[o],cubeX,t+checkerSize*o);var t=topY-lineWidth+e+5*checkerSize;r>1&&(t-=checkerSize/2*(r-1)),midCubes[o]<maxCubes&&bglog.animateCube(midCubes[o],cubeX,t+checkerSize*o);var t=topY+doubleLineWidth+e+10*checkerSize;botCubes[o]<maxCubes&&bglog.animateCube(botCubes[o],cubeX,t-checkerSize*o)}},drawCheckers:function(){for(var e=0,r=0,o=0;25>o;o++)e+=ourBoard[o],r+=oppBoard[o];for(var o=0;25>o;o++)bglog.generateMoveList("rem",o,ourBoard[o],ourBoard,e),bglog.generateMoveList("rem",o,oppBoard[o],oppBoard,r);for(var o=0;25>o;o++)bglog.generateMoveList("add",o,ourBoard[o],ourBoard,e),bglog.generateMoveList("add",o,oppBoard[o],oppBoard,r);bglog.runMoveList()},generateMoveList:function(e,r,o,t,i){var c=e,a=r,n=o,h=t,u=i,l=ourCheckerNameArray,s=ourTrayCheckerArray,d="our";h==oppBoard&&(l=oppCheckerNameArray,s=oppTrayCheckerArray,d="opp");for(var p=0,g=-1,b=0;15>b&&-1!=l[a][b];b++)p++,g=l[a][b];if(u-h[a]+n>15&&(n=15-(u-h[a])),6>n){if(p>n&&"rem"==c)for(var b=p-n;b>0;b--)p--,g=l[a][p],l[a][p]=-1,s.push(g),thisFromPoint=a,bglog.pointToXY(-1,0,h),moveListArray[g].push(pointX,pointY);else if(n>p&&"add"==c){n-=p;for(var b=0;n>b;b++){if(0==s.length)return void console.log("trayCheckerArray error, move ignored.");g=s.pop(),l[a][p]=g,thisFromPoint=-1,bglog.pointToXY(a,p++,h),moveListArray[g].push(pointX,pointY)}}}else if("add"==c){n-p>15&&(n=15-u);for(var m=n-p,b=0;m>b;b++){if(0==s.length)return void console.log("trayCheckerArray error, move ignored.");g=s.pop(),l[a][p]=g,thisFromPoint=-1,bglog.pointToXY(a,p++,h),moveListArray[g].push(pointX,pointY)}}},moveToTop:function(e){var r=e[0];r.ownerSVGElement.appendChild(r)},moveChecker:function(e,r,o,t){if(-1==e)return void console.log("checkerName -1 ignored");firstRoll=!1,thisMovingChecker=$("#checker"+e);"#"+thisMovingChecker.attr("id");if(currX=currY=0,thisMovingChecker[0]._gsTransform&&(currX=thisMovingChecker[0]._gsTransform.x,currY=thisMovingChecker[0]._gsTransform.y),currX==r&&currY==o)return void console.log("No move required");thisMovingChecker.show();var i=$("#checkerText"+e);i.text("");var c=$("#checkerCircle"+e);animateFlag||(t=0),checkerTweenActive=!0,checkerTween=TweenLite.to(thisMovingChecker,t,{paused:!0,overwrite:"all",x:r,y:o,ease:Power2.easeInOut,onStart:bglog.moveToTop(thisMovingChecker),onComplete:bglog.tweenComplete}),snapBackFlag||dragging||(currX==trayX&&TweenLite.to(c,t/2,{attr:{height:checkerHeight,rx:checkerSize},ease:Linear.easeNone,delay:t/4}),r==trayX?TweenLite.to(c,t/3,{attr:{height:trayCheckerHeight,rx:trayCheckerCornerRadius},ease:Linear.easeNone,delay:t/2}):TweenLite.to(c,t/2,{overwrite:"all",attr:{height:checkerHeight,rx:checkerSize},ease:Linear.easeNone})),bglog.restack(),checkerTween.play()},tweenComplete:function(){checkerTweenActive=!1,snapBackFlag=!1,thisMovingChecker=this.target;var e=thisMovingChecker.attr("id");checkerName=parseInt(e.substring(7)),bglog.restack(),bglog.moveToTop($("#touch"))},restack:function(){currentTheme.stacking||(bglog.restackBoard(ourBoard,ourCheckerNameArray),bglog.restackBoard(oppBoard,oppCheckerNameArray))},restackBoard:function(e,r){for(var o=0;o<e.length;o++)if(e[o]>4){var t=$("#checkerText"+r[o][4]);if(e[o]>5){for(var i=e[o]-5,c=i;c>0;c--){var a=r[o][c+4];$("#checker"+a).hide()}t.text(e[o])}else t.text("")}},pointToXY:function(e,r,o){if(savePoint=e,savePos=r,24==e){var t=topY+lineWidth/2+4*checkerSize,i=bottomY-lineWidth/2-5*checkerSize;maxOnPoint=4,pointX=leftX+6*checkerSize,pointX=Math.round(pointX);var c=i;o==ourBoard&&(c=t);for(var a=maxOnPoint,n=c,h=0;r>=h;h++)if(c==t?pointY=n-checkerSize*r:pointY=n+checkerSize*r,0==a--)if(maxOnPoint--,maxOnPoint>0){a=maxOnPoint-1;var u=maxOnPoint*checkerSize+checkerSize/2;c==t?(pointY+=u,n+=u):(pointY-=u,n-=u)}else a=0,pointY=saveY;return pointY=Math.round(pointY),void(saveY=pointY)}if(0>e)if(pointX=trayX,o==ourBoard){var l=ourTrayCheckerArray.length-1;pointY=bottomY-doubleLineWidth-trayCheckerHeight*(l+1),pointY+=lineWidth/2,l>2&&(pointY-=3*lineWidth),l>5&&(pointY-=3*lineWidth),l>8&&(pointY-=3*lineWidth),l>11&&(pointY-=3*lineWidth)}else{var l=oppTrayCheckerArray.length-1;pointY=topY-trayCheckerHeight+lineWidth+trayCheckerHeight*(l+1),pointY+=lineWidth/2,l>2&&(pointY+=3*lineWidth),l>5&&(pointY+=3*lineWidth),l>8&&(pointY+=3*lineWidth),l>11&&(pointY+=3*lineWidth)}else{var s=-(savePoint-23),t=topY+doubleLineWidth,c=bottomY-checkerSize,d=rightX;currentTheme.direction&&(d=leftX),o==ourBoard&&(c=t),savePoint<12&&(s=-(savePoint-11),c=c==t?bottomY-lineWidth/2-checkerSize:t,d=d==leftX?rightX:leftX),d==rightX?(pointX=d-checkerSize*s,s>5&&(pointX-=checkerSize)):(pointX=d+checkerSize*s,s>5&&(pointX+=checkerSize)),pointY=c,maxOnPoint=5;for(var p,a=maxOnPoint-1,n=c,h=0;r>h;h++)if(c==t?(pointY=n+checkerSize*r,p=n+checkerSize*(maxOnPoint-1)):(pointY=n-checkerSize*r,p=n-checkerSize*(maxOnPoint-1)),r+1>maxOnPoint&&!currentTheme.stacking)pointY=p;else if(0==a--)if(maxOnPoint--,maxOnPoint>0){a=maxOnPoint-1;var u=maxOnPoint*checkerSize+checkerSize/2;c==t?(pointY-=u,n-=u):(pointY+=u,n+=u)}else a=0,pointY=saveY;pointX=Math.round(pointX),pointY=Math.round(pointY),saveY=pointY}},updatePipCount:function(){bglog.getPipCount(),$("#ourPipcount").text(ourPipCount),$("#oppPipcount").text(oppPipCount),currentTheme.showPipCount?($("#ourPipcount").show(),$("#oppPipcount").show()):($("#ourPipcount").hide(),$("#oppPipcount").hide())},doPointNumbers:function(){$(".pointNumbers").hide(),currentTheme.showPointNumbers&&(currentTheme.direction?currentTheme.cpStyle?($("#top1to12").show(),$("#mid24to13").show(),$("#bot1to12").show()):roll?($("#top24to13").show(),$("#bot1to12").show()):($("#top1to12").show(),$("#bot24to13").show()):currentTheme.cpStyle?($("#top12to1").show(),$("#mid13to24").show(),$("#bot12to1").show()):roll?($("#top13to24").show(),$("#bot12to1").show()):($("#top12to1").show(),$("#bot13to24").show()))},xgPosToBoard:function(e){var r="-abcdefghijklmnoABCDEFGHIJKLMNO",o=0;e=e.split("=").pop();for(var t=1;24>=t;t++)o=r.indexOf(e[t]),o>15&&(o=0),oppBoard[-(t-24)]=o;o=r.indexOf(e[0]),o>15&&(o=0),oppBoard[24]=o;for(var t=1;24>=t;t++)o=r.indexOf(e[t]),15>=o?o=0:o-=15,ourBoard[t-1]=o;o=r.indexOf(e[25]),15>=o?o=0:o-=15,ourBoard[24]=o},xgMatchToBoard:function(e){e=e.split("=").pop(),e+=":";for(var r=27,o="";":"!=e[r];)o+=e[r++];r++,cubeValue=parseInt(o);for(var t="";":"!=e[r];)t+=e[r++];r++,t=parseInt(t),cubePos="mid",1==t&&(cubePos="bot"),-1==t&&(cubePos="top");for(var i="";":"!=e[r];)i+=e[r++];for(r++,i=parseInt(i),-1==i?(roll=!1,turn=!1):(roll=!0,turn=!0),cubeStatus=0,cubeFlag=!1,leftDie=rightDie=0;":"!=e[r];)thisLeftDie=e[r++],"D"==thisLeftDie||"B"==thisLeftDie||"R"==thisLeftDie?(cubeFlag=!0,cubeStatus=1,roll?bglog.moveCube(cubeNumber,"oppside",cubeValue+1):bglog.moveCube(cubeNumber,"ourside",cubeValue+1)):thisRightDie=e[r++],1==cubeStatus?turn=roll?!1:!0:("-"!=thisLeftDie&&(leftDie=parseInt(thisLeftDie)),"-"!=thisRightDie&&(rightDie=parseInt(thisRightDie)));r++,diceToPlay=2,pipsToMove=leftDie+rightDie,leftDie==rightDie&&(pipsToMove+=pipsToMove,diceToPlay=4),bglog.clearMoveArray(),moveCount=0;for(var c="";":"!=e[r];)c+=e[r++];r++,ourScore=parseInt(c);for(var a="";":"!=e[r];)a+=e[r++];r++,oppScore=parseInt(a),xgCrawford=parseInt(e[r++]),r++;for(var n="";":"!=e[r];)n+=e[r++];r++,matchLength=parseInt(n),0==matchLength?thisLabel="money":thisLabel="match",bglog.updateScores(),crawfordFlag=0,"match"==thisLabel?crawfordFlag=1==xgCrawford?1:0:(0==xgCrawford&&(jacobyFlag=0,beaverFlag=0),1==xgCrawford&&(jacobyFlag=1,beaverFlag=0),2==xgCrawford&&(jacobyFlag=0,beaverFlag=1),3==xgCrawford&&(jacobyFlag=1,beaverFlag=1));for(var h="";":"!=e[r];)h+=e[r++];maxCube=parseInt(h),cubeFlag||bglog.moveCube(1,cubePos,cubeValue)},updateScores:function(){currentTheme.awayStyle?($("#oppScoreText").text("–"+(matchLength-oppScore)),$("#ourScoreText").text("–"+(matchLength-ourScore))):($("#oppScoreText").text(oppScore+"/"+matchLength),$("#ourScoreText").text(ourScore+"/"+matchLength)),currentTheme.showScore?(currentTheme.showScore=!1,bglog.toggleScore()):(currentTheme.showScore=!0,bglog.toggleScore()),$("#ourScoreText").attr("fill",currentTheme.textColor),$("#oppScoreText").attr("fill",currentTheme.textColor),currentTheme.showTurnIndicator&&(currentTheme.direction?($("#ourScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2),$("#oppScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2),$("#ourTurnChecker").attr("cx",leftX-checkerSize-borderWidth+checkerSize/2),$("#oppTurnChecker").attr("cx",leftX-checkerSize-borderWidth+checkerSize/2)):($("#ourScoreText").attr("x",leftX-borderWidth-checkerSize/2),$("#oppScoreText").attr("x",leftX-borderWidth-checkerSize/2),$("#ourTurnChecker").attr("cx",rightX+checkerSize+borderWidth+checkerSize/2),$("#oppTurnChecker").attr("cx",rightX+checkerSize+borderWidth+checkerSize/2))),roll?currentTheme.showTurnIndicator?($("#oppTurnChecker").hide(),$("#ourTurnChecker").show()):$("#ourScoreText").attr("fill",currentTheme.highlightColor):currentTheme.showTurnIndicator?($("#oppTurnChecker").show(),$("#ourTurnChecker").hide()):$("#oppScoreText").attr("fill",currentTheme.highlightColor)},loadTheme:function(theme){currentTheme=eval(theme);var checkerWidth=checkerSize-doubleLineWidth;$(".takiPoint").hide(),$(".nonTakiPoint").hide(),currentTheme.takiPoints?$(".takiPoint").show():$(".nonTakiPoint").show(),$("#canvas").attr("fill",currentTheme.canvasColor),$("#border").attr("fill",currentTheme.borderColor),$(".surface").attr("fill",currentTheme.surfaceColor),$(".tray").attr("fill",currentTheme.trayColor),$("#bar").attr("fill",currentTheme.barColor),$(".pointA").attr("fill",currentTheme.pointBcolor),$(".pointA").attr("stroke",currentTheme.pointOutlines),$(".pointA").css("strokeWidth",lineWidth),$(".pointB").attr("fill",currentTheme.pointAcolor),$(".pointB").attr("stroke",currentTheme.pointOutlines),$(".pointB").css("strokeWidth",lineWidth),$(".pointNumbers").attr("fill",currentTheme.textColor),$(".pointNumbers").css("textShadow","none"),$("#oppPipcount").attr("fill",currentTheme.pipcountTextColor),$("#oppPipcount").css("textShadow","none"),$("#ourPipcount").attr("fill",currentTheme.pipcountTextColor),$("#ourPipcount").css("textShadow","none"),$(".ourchecker").attr("width",checkerWidth),$(".ourchecker").attr("fill",currentTheme.ourCheckerColor),$(".ourchecker").attr("stroke","#000"),$(".ourchecker").css("strokeWidth",lineWidth),$(".ourcheckertext").attr("fill",currentTheme.ourStackingColor),$("#ourTurnChecker").attr("fill",currentTheme.ourCheckerColor),$("#ourTurnChecker").attr("stroke","#000"),$("#ourTurnChecker").attr("r",checkerWidth/5),$(".oppchecker").attr("width",checkerWidth),$(".oppchecker").attr("fill",currentTheme.oppCheckerColor),$(".oppchecker").attr("stroke","#000"),$(".oppchecker").css("strokeWidth",lineWidth),$(".oppcheckertext").attr("fill",currentTheme.oppStackingColor),$("#oppTurnChecker").attr("fill",currentTheme.oppCheckerColor),$("#oppTurnChecker").attr("stroke","#000"),$("#oppTurnChecker").attr("r",checkerWidth/5),$(".cubes").attr("fill",currentTheme.cubeColor),$(".cubes").attr("stroke",currentTheme.pointOutlines),$(".cubes").css("strokeWidth",doubleLineWidth),$(".cubeText").attr("fill",currentTheme.cubeTextColor),$(".cubeText").attr("stroke","none"),$(".cubeText").css("fontSize",cubeFontSize),$(".cubeText").css("textShadow","none"),$("#cube0").css("visibility","visible"),$("#cube0Text").text("64"),$(".ourdice").attr("fill",currentTheme.ourCheckerColor),$(".ourDicePips").attr("fill",currentTheme.ourDicePipColor),$(".ourDicePips").attr("r",dicePipRadius),$(".oppdice").attr("fill",currentTheme.oppCheckerColor),$(".oppDicePips").attr("fill",currentTheme.oppDicePipColor),$(".oppDicePips").attr("r",dicePipRadius),currentTheme.direction?currentTheme.direction=!1:currentTheme.direction=!0,bglog.toggleDirection()},initCheckers:function(){for(var e=0;30>e;e++){var r=$("#checker"+e),o=$("#checkerCircle"+e);TweenLite.set(r,{x:trayX,y:middleY}),TweenLite.set(o,{attr:{height:checkerHeight,rx:checkerSize}})}for(var e=0;15>e;e++)ourTrayCheckerArray.push(e);for(var e=15;30>e;e++)oppTrayCheckerArray.push(e)},base64_decode:function(e){var r,o,t,i,c,a,n,h,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,s=0,d="",p=[];if(!e)return e;e+="";do i=u.indexOf(e.charAt(l++)),c=u.indexOf(e.charAt(l++)),a=u.indexOf(e.charAt(l++)),n=u.indexOf(e.charAt(l++)),h=i<<18|c<<12|a<<6|n,r=h>>16&255,o=h>>8&255,t=255&h,64==a?p[s++]=String.fromCharCode(r):64==n?p[s++]=String.fromCharCode(r,o):p[s++]=String.fromCharCode(r,o,t);while(l<e.length);return d=p.join("")},hexdec:function(e){return e=(e+"").replace(/[^a-f0-9]/gi,""),parseInt(e,16)},bin2hex:function(e){var r,o,t,i="";for(e+="",r=0,o=e.length;o>r;r++)t=e.charCodeAt(r).toString(16),i+=t.length<2?"0"+t:t;return i},boardToXGpos:function(){var e="-abcdefghijklmnoABCDEFGHIJKLMNO";xgPos="XGID=",xgPos+=0!=oppBoard[24]?e[oppBoard[24]+0]:"-";for(var r=0;24>r;r++)xgPos+=0!=ourBoard[r+0]?e[ourBoard[r]+15]:0!=oppBoard[-(r-23)]?e[oppBoard[-(r-23)]+0]:"-";xgPos+=0!=ourBoard[24]?e[ourBoard[r]+15]:"-";var o=0;"top"==cubePos&&(o=-1),"bot"==cubePos&&(o=1);var t=-1;roll&&(t=1),0==matchLength?(xgCrawfordFlag=jacobyFlag+2*beaverFlag,thisLabel="money"):(xgCrawfordFlag=crawfordFlag,thisLabel="match"),bglog.updateScores();var i=leftDie,c=rightDie;cubeFlag&&(i="D",c=""),"-"==thisLeftDie&&(i=thisLeftDie),"-"==thisRightDie&&(c=thisRightDie),xgPos+=":"+cubeValue+":"+o+":"+t+":"+i+c+":",xgPos+=ourScore+":"+oppScore+":"+xgCrawfordFlag+":"+matchLength+":"+maxCube},matchid2board:function(e){idWarningFlag=!1,idErrorFlag=!1,idMessage="";for(var r="",o="",t=bglog.base64_decode(e),i=0;9>i;i++)r+=sprintf("%08b",bglog.hexdec(bglog.bin2hex(t[i])));for(var i=0;9>i;i++)for(var c=7;c>=0;c--)o+=r[8*i+c];i=66,gnuJacoby=bglog.bindec(o[i]),jacobyFlag=0==gnuJacoby?1:0,i--,char="";for(var c=0;15>c;c++)char+=o[i],i--;ourScore=bglog.bindec(char),ourScore>98&&(idMessage="Warning: bottom player score reset from "+ourScore+" to 98.",ourScore=98,idWarningFlag=!0),char="";for(var c=0;15>c;c++)char+=o[i],i--;oppScore=bglog.bindec(char),oppScore>98&&(idMessage="Warning: top player score reset from "+oppScore+" to 98.",oppScore=98,idWarningFlag=!0),char="";for(var c=0;15>c;c++)char+=o[i],i--;if(matchLength=bglog.bindec(char),matchLength>99&&(idMessage="Warning: match length reset from "+matchLength+" to 99.",matchLength=99,idWarningFlag=!0),matchLength>0){if(ourScore>matchLength-1)return idMessage="Bottom player score invalid - must be less than match length.",idErrorFlag=!0,!1;if(oppScore>matchLength-1)return idMessage="Top player score invalid - must be less than match length.",idErrorFlag=!0,!1}bglog.updateScores(),thisLabel="match",0==matchLength&&(thisLabel="money"),char="";for(var c=0;3>c;c++)char+=o[i],i--;if(rightDie=bglog.bindec(char),rightDie>6)return idMessage="Error: right die "+rightDie+", should be 0-6.",idErrorFlag=!0,rightDie=0,!1;char="";for(var c=0;3>c;c++)char+=o[i],i--;if(leftDie=bglog.bindec(char),leftDie>6)return idMessage="Error: left die "+leftDie+", should be 0-6.",idErrorFlag=!0,leftDie=0,!1;char="";for(var c=0;2>c;c++)char+=o[i],i--;res=bglog.bindec(char),cubeStatus=bglog.bindec(o[i]),cubeFlag=!1,0!=cubeStatus&&(cubeFlag=!0),i--,gnuTurn=bglog.bindec(o[i]),turn=!0,0==gnuTurn&&(turn=!1),i--,char="";for(var c=0;3>c;c++)char+=o[i],i--;if(gameState=bglog.bindec(char),gameState>4)return idMessage="Error: invalid game state "+gameState+", should be 0-4.",idErrorFlag=!0,gameState=0,!1;if(crawfordFlag=bglog.bindec(o[i]),i--,0!=crawfordFlag&&1!=crawfordFlag)return idMessage="Crawford flag must be 0 or 1.",idErrorFlag=!0,!1;if(1==crawfordFlag&&ourScore!=matchLength-1&&oppScore!=matchLength-1)return idMessage="Crawford flag invalid at this score.",idErrorFlag=!0,!1;gnuRoll=bglog.bindec(o[i]),roll=!0,0==gnuRoll&&(roll=!1),i--,char="";for(var c=0;2>c;c++)char+=o[i],i--;var a=bglog.bindec(char);if(0==a)cubePos="top";else if(1==a)cubePos="bot";else{if(3!=a)return idMessage="Error: invalid cube owner "+a,idErrorFlag=!0,a=3,!1;cubePos="mid"}char="";for(var c=0;4>c;c++)char+=o[i],i--;if(cubeValue=bglog.bindec(char),cubeValue>6){var n=Math.pow(2,cubeValue);idMessage="Warning: cube value "+n+" reduced to 64.",cubeValue=6,idWarningFlag=!0}return cubeFlag?roll?bglog.moveCube(cubeNumber,"oppside",cubeValue+1):bglog.moveCube(cubeNumber,"ourside",cubeValue+1):bglog.moveCube(cubeNumber,cubePos,cubeValue),!0},posid2board:function(e){for(var r="",o="",t=[],i=bglog.base64_decode(e),c=0;10>c;c++)r+=sprintf("%08b",bglog.hexdec(bglog.bin2hex(i[c])));for(var c=0;10>c;c++)for(var a=7;a>=0;a--)o+=r[8*c+a];for(var n=0,a=0,h=0,u=[],l=[],c=0;80>c;c++){for(;1==o[c];)h++,n++,c++;t[a++]=parseInt(sprintf("%2d",n)),n=0}if(h>30)return idMessage="Error: too many checkers!",idErrorFlag=!0,!1;for(var c=0;25>c;c++)roll?(l[c]=t[c],u[c]=t[c+25]):(l[c]=t[c+25],u[c]=t[c]);for(var s=0,d=0,c=0;25>c;c++)s+=u[c],d+=l[c];if(s>15||d>15)return idMessage="Error: too many checkers!",idErrorFlag=!0,!1;for(var c=0;24>c;c++)if(0!=u[c]&&0!=l[-c+23])return idMessage="Error: illegal checker placement!",idErrorFlag=!0,!1;return ourBoard=u,oppBoard=l,!0},bindec:function(e){return e=(e+"").replace(/[^01]/gi,""),parseInt(e,2)},makeBoard:function(e){(void 0===e||null===e)&&(e=60),leftDie=0,rightDie=0;var r=["1","2","4","8","16","32","64","C"];r[0];borderWidth=2,pipCountFontSize=e/2,pointNumberFontSize=e/12*5;var o=17*e+4*borderWidth,t=11*e+2*borderWidth+2*pipCountFontSize,i=15*e+4*borderWidth,c=11*e+2*borderWidth;cubeWidth=e/6*5,cubeFontSize=e/6*4;var a=e/6*4;dicePipRadius=e/12,startX=2*e+2*borderWidth+doubleLineWidth,startY=pipCountFontSize+borderWidth+doubleLineWidth,endX=startX+e-4*lineWidth;var n=startX+e/2-doubleLineWidth,h=startY+5*e,u=startY+e/2,l="pointA";leftX=2*e+2*borderWidth+lineWidth,rightX=leftX+12*e,middleX=leftX+6*e,topY=borderWidth+pipCountFontSize,bottomY=topY+11*e,middleY=topY+5*e+e/2,trayX=rightX+e+borderWidth,currentTheme.direction&&(trayX=leftX-e-borderWidth),trayCheckerHeight=e/3-lineWidth,checkerHeight=checkerSize-doubleLineWidth,maxCube=10;for(var s="ourchecker",d=8*e+2*borderWidth+(e-cubeWidth)/2,p=5*e+borderWidth+pipCountFontSize+(e-cubeWidth)/2,g=cubeWidth/7,b=4*e+2*borderWidth+(e-a)/2,m=5*e+borderWidth+pipCountFontSize+(e-a)/2,f="<svg id='svgboard' version='1.1' xmlns='http://www.w3.org/2000/svg' viewbox='0 0 "+o+" "+t+"' style='position: absolute; height: 100%; width: 100%; left: 0; top: 0;' ><rect id='canvas' x='0' y='0' width='"+o+"' height='"+t+"'></rect><rect id='border' x='"+e+"' y='"+pipCountFontSize+"' width='"+i+"' height='"+c+"'></rect><rect id='toplefttray' class='tray' x='"+(e+borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+e+"' height='"+5*e+"'></rect><rect id='botlefttray' class='tray' x='"+(e+borderWidth)+"' y='"+(pipCountFontSize+borderWidth+6*e)+"' width='"+e+"' height='"+5*e+"'></rect><rect id='leftsurface' class='surface' x='"+(2*e+2*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+6*e+"' height='"+11*e+"'></rect><rect id='bar' x='"+(8*e+3*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+(e-2*borderWidth)+"' height='"+11*e+"'></rect><rect id='rightsurface' class='surface' x='"+(9*e+2*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+6*e+"' height='"+11*e+"'></rect><rect id='toprighttray' class='tray' x='"+(15*e+3*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+e+"' height='"+5*e+"'></rect><rect id='botrighttray' class='tray' x='"+(15*e+3*borderWidth)+"' y='"+(pipCountFontSize+borderWidth+6*e)+"' width='"+e+"' height='"+5*e+"'></rect>",k=pipCountFontSize+borderWidth+doubleLineWidth-e/6,C=0,v=0;24>v;v++)6==C&&C++,
12==v&&(C=0,startY=pipCountFontSize+borderWidth-doubleLineWidth+11*e,k+=11.5*e-4*lineWidth-e/6,h=startY-5*e,u=startY-e/2,l="pointB"),f+="<path d='M"+(startX+e*C)+" "+u+" C"+(startX+e*C)+" "+k+" "+(endX+e*C)+" "+k+" "+(endX+e*C)+" "+u+" L"+(n+e*C)+" "+h+"z' class='takiPoint "+l+"'></path>",f+="<path d='M"+(startX+e*C)+" "+startY+" L"+(endX+e*C)+" "+startY+" "+(n+e*C)+" "+h+"z' class='nonTakiPoint "+l+"'></path>",l="pointA"==l?"pointB":"pointA",C++;var x=2*e+e/2+2*borderWidth,T=pipCountFontSize-3*doubleLineWidth;f+="<g id='top1to12' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=1;12>=v;v++)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",6==v&&(y+=e),y+=e;f+="</g>",f+="<g id='top13to24' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=13;24>=v;v++)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",18==v&&(y+=e),y+=e;f+="</g>",f+="<g id='top12to1' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=12;v>=1;v--)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",7==v&&(y+=e),y+=e;f+="</g>",f+="<g id='top24to13' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=24;v>=13;v--)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",19==v&&(y+=e),y+=e;f+="</g>",T=h-e/3,f+="<g id='mid1to12' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=1;12>=v;v++)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",6==v&&(y+=e),y+=e;f+="</g>",f+="<g id='mid13to24' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=13;24>=v;v++)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",18==v&&(y+=e),y+=e;f+="</g>",f+="<g id='mid12to1' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=12;v>=1;v--)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",7==v&&(y+=e),y+=e;f+="</g>",f+="<g id='mid24to13' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=24;v>=13;v--)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",19==v&&(y+=e),y+=e;f+="</g>",T=bottomY+pointNumberFontSize+borderWidth,f+="<g id='bot1to12' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=1;12>=v;v++)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",6==v&&(y+=e),y+=e;f+="</g>",f+="<g id='bot13to24' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=24;v>=13;v--)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",19==v&&(y+=e),y+=e;f+="</g>",f+="<g id='bot12to1' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=12;v>=1;v--)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",7==v&&(y+=e),y+=e;f+="</g>",f+="<g id='bot24to13' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,v=24;v>=13;v--)f+="<text x='"+y+"' y='"+T+"'>"+v+"</text>",19==v&&(y+=e),y+=e;f+="</g>";var P=leftX+6.5*e-lineWidth;f+="<text id='oppPipcount' x='"+P+"' y='"+(pipCountFontSize-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle' ></text>",f+="<text id='ourPipcount' x='"+P+"' y='"+(bottomY+pipCountFontSize+borderWidth-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle'></text>";var y=leftX-borderWidth-e/2;if(currentTheme.direction&&currentTheme.showTurnIndicator)var y=rightX+borderWidth+e/2;f+="<text id='oppScoreText' x='"+y+"' y='"+(pipCountFontSize-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle' ></text>",f+="<text id='ourScoreText' x='"+y+"' y='"+(bottomY+pipCountFontSize+borderWidth-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle' ></text>";for(var v=0;30>v;v++)f+="<g id='checker"+v+"' x='0' y='0'>",f+="<rect id='checkerCircle"+v+"' class='"+s+"' x='0' y='0'></rect>",f+="<text id='checkerText"+v+"' class='"+s+"text' x='"+(e/2-lineWidth)+"' y='"+e/3*2+"' text-anchor='middle' font-family='arial' font-size='"+e/2+"'></text>",f+="</g>",14==v&&(s="oppchecker");var y=rightX+e+borderWidth+e/2;if(currentTheme.direction&&currentTheme.showTurnIndicator)var y=leftX-e-borderWidth+e/2;f+="<circle id='ourTurnChecker' cx='"+y+"' cy='"+(bottomY+borderWidth+e/4)+"'></circle><circle id='oppTurnChecker' cx='"+y+"' cy='"+(e/4+lineWidth)+"'></circle>";for(var v=0;maxCubes>v;v++)f+="<g id='cube"+v+"'class='cubes' x='"+d+"' y='"+p+"' style='visibility:hidden' ><rect x='0' y='0' width='"+cubeWidth+"' height='"+cubeWidth+"' rx='"+g+"'></rect><text id='cube"+v+"Text' class='cubeText' x='"+cubeWidth/2+"' y='"+a+"' text-anchor='middle'>64</text></g>";var S=b+a/4,w=S+a/4,z=w+a/4,W=m+a/4,F=W+a/4,B=F+a/4;f+="<g id='oppLeftDie' class='dice oppdice'><rect  x='"+b+"' y='"+m+"' width='"+a+"' height='"+a+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g><circle class='oppDicePips' id='oppLtlPip' cx='"+S+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppLtrPip' cx='"+z+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppLclPip' cx='"+S+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppLcPip' cx='"+w+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppLcrPip' cx='"+z+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppLblPip' cx='"+S+"' cy='"+B+"'></circle><circle class='oppDicePips' id='oppLbrPip' cx='"+z+"' cy='"+B+"'></circle></g></g>",S+=e,w+=e,z+=e,b+=e,f+="<g id='oppRightDie' class='dice oppdice'><rect x='"+b+"' y='"+m+"' width='"+a+"' height='"+a+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g class='dicePips'><circle class='oppDicePips' id='oppRtlPip' cx='"+S+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppRtrPip' cx='"+z+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppRclPip' cx='"+S+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppRcPip' cx='"+w+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppRcrPip' cx='"+z+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppRblPip' cx='"+S+"' cy='"+B+"'></circle><circle class='oppDicePips' id='oppRbrPip' cx='"+z+"' cy='"+B+"'></circle></g></g>",S+=6*e,w+=6*e,z+=6*e,b+=6*e,f+="<g id='ourLeftDie' class='dice ourdice'><rect x='"+b+"' y='"+m+"' width='"+a+"' height='"+a+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g><circle class='ourDicePips' id='ourLtlPip' cx='"+S+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourLtrPip' cx='"+z+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourLclPip' cx='"+S+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourLcPip' cx='"+w+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourLcrPip' cx='"+z+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourLblPip' cx='"+S+"' cy='"+B+"'></circle><circle class='ourDicePips' id='ourLbrPip' cx='"+z+"' cy='"+B+"'></circle></g></g>",S+=e,w+=e,z+=e,b+=e,f+="<g id='ourRightDie' class='dice ourdice'><rect x='"+b+"' y='"+m+"' width='"+a+"' height='"+a+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g class='dicePips'><circle class='ourDicePips' id='ourRtlPip' cx='"+S+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourRtrPip' cx='"+z+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourRclPip' cx='"+S+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourRcPip' cx='"+w+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourRcrPip' cx='"+z+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourRblPip' cx='"+S+"' cy='"+B+"'></circle><circle class='ourDicePips' id='ourRbrPip' cx='"+z+"' cy='"+B+"'></circle></g></g>",f+="<rect id='touch' x='0' y='0' width='"+o+"' height='"+t+"' fill='rgba(0,0,0,0)'></rect>",f+="</svg>",$("#bglogContainer").html(f),bglog.initCheckers()}};